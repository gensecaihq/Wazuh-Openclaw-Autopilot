# Wazuh Autopilot Configuration Template
# Copy this file to /etc/wazuh-autopilot/.env and update values
#
# See docs/QUICKSTART.md for setup instructions

# =============================================================================
# DEPLOYMENT MODE
# =============================================================================

# Deployment mode: bootstrap | production
# - bootstrap: Allows non-Tailnet MCP URLs (for evaluation/testing)
# - production: Requires Tailnet MCP URL (recommended for enterprise)
AUTOPILOT_MODE=bootstrap

# Require Tailscale in production mode (true/false)
# When true and AUTOPILOT_MODE=production, the system will refuse to start
# unless Tailscale is running and MCP_URL is a Tailnet address
AUTOPILOT_REQUIRE_TAILSCALE=true

# =============================================================================
# MCP SERVER CONFIGURATION
# =============================================================================

# Production MCP URL (required in production mode)
# Must be a Tailnet URL when AUTOPILOT_MODE=production
# Examples:
#   - https://mcp.your-tailnet.ts.net:3000
#   - https://100.x.x.x:3000
MCP_URL=

# Bootstrap MCP URL (used in bootstrap mode if MCP_URL not set)
# Can be any reachable URL including LAN or public addresses
# Examples:
#   - http://192.168.1.100:3000
#   - https://mcp.example.com:3000
MCP_BOOTSTRAP_URL=

# MCP Authentication Token
# JWT or API key for authenticating with the MCP server
AUTOPILOT_MCP_AUTH=

# MCP request timeout (milliseconds)
MCP_TIMEOUT_MS=30000

# =============================================================================
# SLACK CONFIGURATION (Optional - Socket Mode)
# =============================================================================
# Slack is NOT required. Without it, approvals are handled via the REST API.
# See docs/SLACK_SOCKET_MODE.md for setup instructions.

# Slack App-Level Token (starts with xapp-)
# Required for Socket Mode connection (no public endpoint needed)
# Create at: https://api.slack.com/apps > Basic Information > App-Level Tokens
SLACK_APP_TOKEN=

# Slack Bot Token (starts with xoxb-)
# Required for posting messages and handling interactions
# Create at: https://api.slack.com/apps > OAuth & Permissions
SLACK_BOT_TOKEN=

# Slack signing secret (optional for Socket Mode, required for HTTP mode)
SLACK_SIGNING_SECRET=

# Channel IDs for notifications
SLACK_ALERTS_CHANNEL=
SLACK_APPROVALS_CHANNEL=
SLACK_REPORTS_CHANNEL=

# =============================================================================
# DATA STORAGE
# =============================================================================

# Data directory for cases, evidence packs, and state
AUTOPILOT_DATA_DIR=/var/lib/wazuh-autopilot

# Configuration directory
AUTOPILOT_CONFIG_DIR=/etc/wazuh-autopilot

# =============================================================================
# AGENT CONFIGURATION
# =============================================================================

# Enable action execution via Responder Agent
# WARNING: Only set to true after:
#   1. Reviewing and customizing policies/policy.yaml
#   2. Testing in bootstrap mode
#   3. Configuring proper approvers
#   4. Understanding the risks
AUTOPILOT_RESPONDER_ENABLED=false

# =============================================================================
# OBSERVABILITY
# =============================================================================

# Enable Prometheus metrics endpoint
METRICS_ENABLED=true

# Service ports (change here to customize all components)
GATEWAY_PORT=18789
MCP_PORT=3000
RUNTIME_PORT=9090

# Metrics bind address
# Use 127.0.0.1 for localhost only (secure)
# Use 0.0.0.0 to expose (not recommended without additional security)
METRICS_HOST=127.0.0.1

# Log format: json | text
LOG_FORMAT=json

# Log level: debug | info | warn | error
LOG_LEVEL=info

# =============================================================================
# OPENCLAW INTEGRATION
# =============================================================================

# OpenClaw installation directory
OPENCLAW_HOME=/opt/openclaw

# OpenClaw Gateway Token
OPENCLAW_TOKEN=

# =============================================================================
# APPROVAL & RATE LIMITING
# =============================================================================

# Approval token TTL (minutes)
APPROVAL_TOKEN_TTL_MINUTES=60

# Response plan expiry (minutes)
PLAN_EXPIRY_MINUTES=60

# Rate limit window (milliseconds)
RATE_LIMIT_WINDOW_MS=60000

# Maximum requests per window
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# LLM PROVIDER API KEYS
# =============================================================================
# Configure keys for your preferred providers. You only need keys for
# providers you intend to use. See openclaw/openclaw.json for model config.
#
# Provider documentation:
# - Anthropic: https://console.anthropic.com/
# - OpenAI: https://platform.openai.com/api-keys
# - Google: https://aistudio.google.com/app/apikey
# - Groq: https://console.groq.com/keys
# - Mistral: https://console.mistral.ai/api-keys
# - xAI: https://console.x.ai/
# - OpenRouter: https://openrouter.ai/keys
# - Together: https://api.together.xyz/settings/api-keys

# Anthropic (Claude) - Recommended for SOC tasks
ANTHROPIC_API_KEY=

# OpenAI - Also used for embeddings in memory search
OPENAI_API_KEY=

# Google AI (Gemini)
GOOGLE_API_KEY=

# Groq - Ultra-fast inference (free tier available)
GROQ_API_KEY=

# Mistral - European AI provider
MISTRAL_API_KEY=

# xAI (Grok)
XAI_API_KEY=

# OpenRouter - Access 300+ models via single API
OPENROUTER_API_KEY=

# Together AI - Open-source model hosting
TOGETHER_API_KEY=

# Cerebras - Ultra-fast inference
CEREBRAS_API_KEY=

# =============================================================================
# INTERNAL SERVICE AUTHENTICATION
# =============================================================================

# Internal service token for agent-to-service communication
AUTOPILOT_SERVICE_TOKEN=

# =============================================================================
# AUTH FAILURE PROTECTION
# =============================================================================

# Time window for tracking auth failures (milliseconds)
AUTH_FAILURE_WINDOW_MS=900000

# Max auth failures before lockout
AUTH_FAILURE_MAX_ATTEMPTS=5

# Lockout duration after max failures (milliseconds)
AUTH_LOCKOUT_DURATION_MS=1800000

# =============================================================================
# CORS CONFIGURATION
# =============================================================================

# Allowed CORS origin (for web UI if applicable)
CORS_ORIGIN=http://localhost:3000

# Enable CORS headers (set to false to disable)
CORS_ENABLED=true

# =============================================================================
# GRACEFUL SHUTDOWN
# =============================================================================

# Timeout for graceful shutdown (milliseconds)
SHUTDOWN_TIMEOUT_MS=30000

# =============================================================================
# WAZUH CONNECTION (optional - used by health checks)
# =============================================================================

# Wazuh host (hostname only, no protocol or port)
# WAZUH_HOST=127.0.0.1

# Wazuh API port (default 55000)
# WAZUH_PORT=55000

# Wazuh API username
# WAZUH_USER=wazuh-wui

# Wazuh API password
# WAZUH_PASS=

# SSL verification settings
# WAZUH_VERIFY_SSL=true
# WAZUH_ALLOW_SELF_SIGNED=true

# =============================================================================
# ADVANCED CONFIGURATION
# =============================================================================

# Correlation time window (minutes)
# CORRELATION_WINDOW_MINUTES=60

# Maximum concurrent agent operations
# MAX_CONCURRENT_OPERATIONS=5
