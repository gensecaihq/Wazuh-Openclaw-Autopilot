{
  // =============================================================================
  // WAZUH OPENCLAW AUTOPILOT — Air-Gapped Configuration (Ollama Only)
  // =============================================================================
  // JSON5 format: comments and trailing commas are allowed.
  //
  // This configuration runs entirely on local Ollama models with NO external
  // network calls. Suitable for air-gapped, classified, or offline environments.
  //
  // Prerequisites:
  //   1. Install Ollama: https://ollama.com/download
  //   2. Pull models: ollama pull llama3.3 && ollama pull mistral
  //   3. Ensure Ollama is running: ollama serve (default http://127.0.0.1:11434)
  //
  // To use different models, update the models.providers.ollama.models array
  // and the agents.defaults.model.primary/fallbacks to match.
  // =============================================================================

  // ---------------------------------------------------------------------------
  // GATEWAY
  // ---------------------------------------------------------------------------
  "gateway": {
    "port": 18789,
    "bind": "loopback",
    "auth": {
      "mode": "token",
      "token": "${OPENCLAW_TOKEN}"
    }
  },

  // ---------------------------------------------------------------------------
  // LOGGING
  // ---------------------------------------------------------------------------
  "logging": {
    "redactSensitive": "tools"
  },

  // ---------------------------------------------------------------------------
  // CUSTOM MODEL PROVIDERS — Ollama via OpenAI-compatible API
  // ---------------------------------------------------------------------------
  // Ollama is not a built-in provider; register it here as a custom provider.
  // The baseUrl points to Ollama's OpenAI-compatible endpoint.
  // ---------------------------------------------------------------------------
  "models": {
    "providers": {
      "ollama": {
        "baseUrl": "http://127.0.0.1:11434/v1",
        "apiKey": "ollama",
        "api": "openai-completions",
        "models": [
          { "id": "llama3.3", "name": "Llama 3.3 70B", "reasoning": true, "input": ["text"], "cost": { "input": 0, "output": 0, "cacheRead": 0, "cacheWrite": 0 }, "contextWindow": 131072, "maxTokens": 4096 },
          { "id": "mistral", "name": "Mistral 7B", "reasoning": false, "input": ["text"], "cost": { "input": 0, "output": 0, "cacheRead": 0, "cacheWrite": 0 }, "contextWindow": 32768, "maxTokens": 4096 },
          { "id": "codellama", "name": "Code Llama 13B", "reasoning": false, "input": ["text"], "cost": { "input": 0, "output": 0, "cacheRead": 0, "cacheWrite": 0 }, "contextWindow": 16384, "maxTokens": 4096 },
          { "id": "llama3.1", "name": "Llama 3.1", "reasoning": true, "input": ["text"], "cost": { "input": 0, "output": 0, "cacheRead": 0, "cacheWrite": 0 }, "contextWindow": 131072, "maxTokens": 4096 },
          { "id": "qwen2.5", "name": "Qwen 2.5", "reasoning": true, "input": ["text"], "cost": { "input": 0, "output": 0, "cacheRead": 0, "cacheWrite": 0 }, "contextWindow": 131072, "maxTokens": 4096 }
        ]
      }
    }
  },

  // ---------------------------------------------------------------------------
  // AGENT CONFIGURATION
  // ---------------------------------------------------------------------------
  "agents": {
    "defaults": {
      "workspace": "~/.openclaw/wazuh-autopilot/workspace",

      "model": {
        "primary": "ollama/llama3.3",
        "fallbacks": ["ollama/mistral"]
      },

      "models": {
        "ollama/llama3.3": { "alias": "llama" },
        "ollama/mistral": { "alias": "mistral" }
      },

      "sandbox": {
        "mode": "all",
        "scope": "session"
      },

      "heartbeat": {
        "every": "30m",
        "model": "ollama/mistral"
      },

      // Local embeddings — no cloud API needed
      "memorySearch": {
        "sources": ["memory", "sessions"],
        "provider": "local",
        "model": "hf:ggml-org/embeddinggemma-300M-GGUF/embeddinggemma-300M.gguf"
      },

      "maxConcurrent": 2,
      "timeoutSeconds": 900
    },

    "list": [
      {
        "id": "wazuh-triage",
        "default": true,
        "workspace": "~/.openclaw/wazuh-autopilot/agents/triage",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/triage",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["write", "edit", "exec", "delete", "browser"]
        },
        "heartbeat": { "every": "10m" }
      },
      {
        "id": "wazuh-correlation",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/correlation",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/correlation",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["write", "edit", "exec", "delete", "browser"]
        },
        "heartbeat": { "every": "5m" }
      },
      {
        "id": "wazuh-investigation",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/investigation",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/investigation",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["write", "edit", "exec", "delete", "browser"]
        }
      },
      {
        "id": "wazuh-response-planner",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/response-planner",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/response-planner",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "write", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["exec", "delete", "browser"]
        }
      },
      {
        "id": "wazuh-policy-guard",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/policy-guard",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/policy-guard",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["write", "edit", "exec", "delete", "browser"]
        }
      },
      {
        "id": "wazuh-responder",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/responder",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/responder",
        "model": {
          "primary": "ollama/llama3.3",
          "fallbacks": ["ollama/mistral"]
        },
        "tools": {
          "profile": "coding",
          "allow": ["read", "write", "exec", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["browser", "delete"],
          "elevated": { "enabled": true }
        },
        "sandbox": {
          "mode": "all",
          "scope": "agent"
        }
      },
      {
        "id": "wazuh-reporting",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/reporting",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/reporting",
        "model": "ollama/mistral",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "write", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["exec", "delete", "browser"]
        }
      }
    ]
  },

  // ---------------------------------------------------------------------------
  // CHANNEL CONFIGURATION
  // ---------------------------------------------------------------------------
  // Slack disabled for air-gapped deployments. Agents operate via REST API
  // and heartbeats. Enable and configure tokens if Slack is available.
  // ---------------------------------------------------------------------------

  // ---------------------------------------------------------------------------
  // GLOBAL TOOL POLICY
  // ---------------------------------------------------------------------------
  "tools": {
    "profile": "minimal",
    "allow": ["read", "sessions_list", "sessions_history"],
    "deny": ["browser", "canvas"],
    "web": {
      "search": { "enabled": false },
      "fetch": { "enabled": false }
    }
  },

  // ---------------------------------------------------------------------------
  // CRON
  // ---------------------------------------------------------------------------
  "cron": {
    "enabled": true,
    "maxConcurrentRuns": 2
  },

  // ---------------------------------------------------------------------------
  // HOOKS — Webhook endpoints for Wazuh alert routing
  // ---------------------------------------------------------------------------
  "hooks": {
    "enabled": true,
    "token": "${OPENCLAW_TOKEN}",
    "mappings": [
      {
        "match": { "path": "/webhook/wazuh-alert" },
        "action": "agent",
        "agentId": "wazuh-triage"
      },
      {
        "match": { "path": "/webhook/case-created" },
        "action": "agent",
        "agentId": "wazuh-correlation"
      },
      {
        "match": { "path": "/webhook/investigation-request" },
        "action": "agent",
        "agentId": "wazuh-investigation"
      },
      {
        "match": { "path": "/webhook/plan-request" },
        "action": "agent",
        "agentId": "wazuh-response-planner"
      },
      {
        "match": { "path": "/webhook/policy-check" },
        "action": "agent",
        "agentId": "wazuh-policy-guard"
      },
      {
        "match": { "path": "/webhook/execute-action" },
        "action": "agent",
        "agentId": "wazuh-responder"
      }
    ]
  },

  // ---------------------------------------------------------------------------
  // ENVIRONMENT VARIABLES
  // ---------------------------------------------------------------------------
  "env": {
    "WAZUH_MCP_URL": "${MCP_URL}",
    "WAZUH_MCP_TOKEN": "${AUTOPILOT_MCP_AUTH}"
  }
}
