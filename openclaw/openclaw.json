{
  // =============================================================================
  // WAZUH OPENCLAW AUTOPILOT - OPENCLAW GATEWAY CONFIGURATION
  // =============================================================================
  // This file is a REFERENCE TEMPLATE. The installer (install.sh) generates the
  // production config at ~/.openclaw/openclaw.json using configured port values.
  // To change ports, update install/env.template and re-run the installer.
  //
  // Supported LLM Providers (configure API keys in env section):
  // - Anthropic (Claude): claude-sonnet-4-5, claude-opus-4-5, claude-haiku-4-5
  // - OpenAI: gpt-4o, gpt-4.5-preview, o3-mini
  // - Google: gemini-2.0-flash, gemini-2.0-pro
  // - Groq: llama-3.3-70b, mixtral-8x7b-32768 (fast inference)
  // - Mistral: mistral-large-latest, codestral-latest
  // - xAI: grok-2, grok-3
  // - Ollama: local models (llama3.3, mistral, etc.)
  // - OpenRouter: 300+ models via single API
  // - Together AI: open-source model hosting
  // - Cerebras: ultra-fast inference
  //
  // Model format: "provider/model-name" (e.g., "anthropic/claude-sonnet-4-5")
  // =============================================================================

  "gateway": {
    "port": 18789,
    "bind": "loopback",
    "auth": {
      "token": "${OPENCLAW_TOKEN}"
    },
    "logging": {
      "redactSensitive": true
    }
  },

  // =============================================================================
  // MODEL PROVIDERS - Configure available LLM providers
  // =============================================================================
  // Built-in providers: anthropic, openai, google, groq, mistral, xai, ollama
  // Set API keys in the env section below or via environment variables
  // =============================================================================
  "models": {
    // Default model for all agents (can be overridden per-agent)
    "default": "anthropic/claude-sonnet-4-5",

    // Model allowlist - agents can only use models from this list
    "allowlist": [
      // Anthropic Claude (recommended for SOC tasks)
      "anthropic/claude-opus-4-5",
      "anthropic/claude-sonnet-4-5",
      "anthropic/claude-haiku-4-5",

      // OpenAI GPT
      "openai/gpt-4o",
      "openai/gpt-4.5-preview",
      "openai/o3-mini",

      // Google Gemini
      "google/gemini-2.0-flash",
      "google/gemini-2.0-pro",

      // Groq (ultra-fast inference)
      "groq/llama-3.3-70b-versatile",
      "groq/mixtral-8x7b-32768",
      "groq/llama-guard-3-8b",

      // Mistral
      "mistral/mistral-large-latest",
      "mistral/codestral-latest",
      "mistral/mistral-small-latest",

      // xAI Grok
      "xai/grok-2",
      "xai/grok-3",

      // Local models via Ollama
      "ollama/llama3.3",
      "ollama/mistral",
      "ollama/codellama",

      // OpenRouter (access 300+ models)
      "openrouter/anthropic/claude-3.5-sonnet",
      "openrouter/meta-llama/llama-3.3-70b-instruct"
    ],

    // Fallback chain - if primary fails, try next in order
    "fallbackChain": [
      "anthropic/claude-sonnet-4-5",
      "openai/gpt-4o",
      "groq/llama-3.3-70b-versatile",
      "ollama/llama3.3"
    ],

    // Provider-specific settings
    "providers": {
      "anthropic": {
        "enabled": true,
        "apiKey": "${ANTHROPIC_API_KEY}",
        "timeout": 120000
      },
      "openai": {
        "enabled": true,
        "apiKey": "${OPENAI_API_KEY}",
        "timeout": 120000
      },
      "google": {
        "enabled": false,
        "apiKey": "${GOOGLE_API_KEY}",
        "timeout": 120000
      },
      "groq": {
        "enabled": false,
        "apiKey": "${GROQ_API_KEY}",
        "timeout": 30000
      },
      "mistral": {
        "enabled": false,
        "apiKey": "${MISTRAL_API_KEY}",
        "timeout": 120000
      },
      "xai": {
        "enabled": false,
        "apiKey": "${XAI_API_KEY}",
        "timeout": 120000
      },
      "ollama": {
        "enabled": false,
        "baseUrl": "http://127.0.0.1:11434/v1",
        "timeout": 300000
      },
      "openrouter": {
        "enabled": false,
        "apiKey": "${OPENROUTER_API_KEY}",
        "timeout": 120000
      },
      "together": {
        "enabled": false,
        "apiKey": "${TOGETHER_API_KEY}",
        "timeout": 120000
      },
      "cerebras": {
        "enabled": false,
        "apiKey": "${CEREBRAS_API_KEY}",
        "timeout": 30000
      }
    }
  },

  // =============================================================================
  // AGENT CONFIGURATION
  // =============================================================================
  "agents": {
    "defaults": {
      "workspace": "~/.openclaw/wazuh-autopilot/workspace",
      "agentDir": "~/.openclaw/wazuh-autopilot/agents",

      "model": {
        // Primary model for complex reasoning tasks
        "primary": "anthropic/claude-sonnet-4-5",
        // Fallback for high availability
        "fallback": "openai/gpt-4o",
        // Fast model for simple tasks (heartbeats, quick checks)
        "fast": "groq/llama-3.3-70b-versatile"
      },

      "sandbox": {
        "mode": "non-main",
        "scope": "session",
        "workspaceAccess": "rw"
      },

      "tools": {
        "profile": "minimal",
        "deny": [
          "browser",
          "canvas",
          "nodes",
          "exec"
        ]
      },

      "heartbeat": {
        "every": "30m",
        "target": "last",
        // Use fast/cheap model for heartbeats
        "model": "anthropic/claude-haiku-4-5"
        // Alternatives: "groq/llama-3.3-70b-versatile" (faster), "ollama/llama3.3" (free)
      },

      "memory": {
        "enabled": true,
        "search": {
          "provider": "openai",
          "model": "text-embedding-3-small",
          "hybrid": true
        }
      }
    },

    "list": [
      // =========================================================================
      // TRIAGE AGENT - First responder for alert analysis
      // =========================================================================
      {
        "id": "wazuh-triage",
        "default": true,
        "workspace": "~/.openclaw/wazuh-autopilot/agents/triage",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/triage/state",

        "model": {
          "primary": "anthropic/claude-sonnet-4-5"
        },

        "tools": {
          "profile": "minimal",
          "allow": [
            "read",
            "sessions_list",
            "sessions_history",
            "sessions_send"
          ],
          "deny": [
            "write",
            "edit",
            "exec",
            "delete",
            "browser",
            "canvas"
          ]
        },

        "heartbeat": {
          "every": "10m"
        }
      },

      // =========================================================================
      // CORRELATION AGENT - Pattern detection and timeline building
      // =========================================================================
      {
        "id": "wazuh-correlation",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/correlation",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/correlation/state",

        "model": {
          "primary": "anthropic/claude-sonnet-4-5"
        },

        "tools": {
          "profile": "minimal",
          "allow": [
            "read",
            "sessions_list",
            "sessions_history",
            "sessions_send"
          ],
          "deny": [
            "write",
            "edit",
            "exec",
            "delete",
            "browser",
            "canvas"
          ]
        }
      },

      // =========================================================================
      // INVESTIGATION AGENT - Deep analysis and evidence gathering
      // =========================================================================
      {
        "id": "wazuh-investigation",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/investigation",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/investigation/state",

        "model": {
          "primary": "anthropic/claude-sonnet-4-5"
        },

        "tools": {
          "profile": "minimal",
          "allow": [
            "read",
            "sessions_list",
            "sessions_history",
            "sessions_send"
          ],
          "deny": [
            "write",
            "edit",
            "exec",
            "delete",
            "browser",
            "canvas"
          ]
        }
      },

      // =========================================================================
      // RESPONSE PLANNER AGENT - Generate response plans (no execution)
      // =========================================================================
      {
        "id": "wazuh-response-planner",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/response-planner",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/response-planner/state",

        "model": {
          "primary": "anthropic/claude-sonnet-4-5"
        },

        "tools": {
          "profile": "minimal",
          "allow": [
            "read",
            "write",
            "sessions_list",
            "sessions_history",
            "sessions_send"
          ],
          "deny": [
            "exec",
            "delete",
            "browser",
            "canvas"
          ]
        }
      },

      // =========================================================================
      // POLICY GUARD AGENT - Constitutional enforcement
      // =========================================================================
      {
        "id": "wazuh-policy-guard",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/policy-guard",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/policy-guard/state",

        "model": {
          "primary": "anthropic/claude-sonnet-4-5"
        },

        "tools": {
          "profile": "minimal",
          "allow": [
            "read",
            "sessions_list",
            "sessions_history",
            "sessions_send"
          ],
          "deny": [
            "write",
            "edit",
            "exec",
            "delete",
            "browser",
            "canvas"
          ]
        }
      },

      // =========================================================================
      // RESPONDER AGENT - Action execution (requires elevated permissions)
      // =========================================================================
      {
        "id": "wazuh-responder",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/responder",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/responder/state",

        "model": {
          "primary": "anthropic/claude-sonnet-4-5"
        },

        "tools": {
          "profile": "coding",
          "allow": [
            "read",
            "write",
            "exec",
            "sessions_list",
            "sessions_history",
            "sessions_send"
          ],
          "deny": [
            "browser",
            "canvas",
            "delete"
          ],
          "elevated": {
            "enabled": true,
            "allowFrom": ["slack"]
          }
        },

        "sandbox": {
          "mode": "all",
          "scope": "agent",
          "workspaceAccess": "rw"
        }
      },

      // =========================================================================
      // REPORTING AGENT - Metrics, KPIs, and digest generation
      // =========================================================================
      {
        "id": "wazuh-reporting",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/reporting",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/reporting/state",

        "model": {
          "primary": "anthropic/claude-haiku-4-5"
        },

        "tools": {
          "profile": "minimal",
          "allow": [
            "read",
            "write",
            "sessions_list",
            "sessions_history",
            "sessions_send"
          ],
          "deny": [
            "exec",
            "delete",
            "browser",
            "canvas"
          ]
        }
      }
    ]
  },

  // =============================================================================
  // CHANNEL ROUTING - Route messages to appropriate agents
  // =============================================================================
  "bindings": [
    // Default triage handles alerts channel
    {
      "agentId": "wazuh-triage",
      "match": {
        "channel": "slack",
        "peer": {
          "kind": "group"
        }
      }
    },

    // Responder handles approval actions
    {
      "agentId": "wazuh-responder",
      "match": {
        "channel": "slack",
        "peer": {
          "id": "approvals"
        }
      }
    }
  ],

  // =============================================================================
  // CHANNEL CONFIGURATION
  // =============================================================================
  "channels": {
    "slack": {
      "enabled": true,
      "dmPolicy": "allowlist",
      "allowFrom": [],
      "groupPolicy": "mention",
      "mentionGating": true
    }
  },

  // =============================================================================
  // TOOL CONFIGURATION
  // =============================================================================
  "tools": {
    "profile": "minimal",
    "allow": [
      "read",
      "sessions_list",
      "sessions_history"
    ],
    "deny": [
      "browser",
      "canvas",
      "nodes",
      "cron"
    ],
    "webSearch": {
      "enabled": false
    },
    "sandbox": {
      "allowlist": [
        "read",
        "sessions_list",
        "sessions_history",
        "sessions_send"
      ],
      "denylist": [
        "browser",
        "canvas",
        "exec",
        "delete"
      ]
    }
  },

  // =============================================================================
  // AUTOMATION - Cron jobs for scheduled reports
  // =============================================================================
  "automation": {
    "cron": [
      {
        "id": "hourly-snapshot",
        "schedule": "0 * * * *",
        "agentId": "wazuh-reporting",
        "model": "anthropic/claude-haiku-4-5"
      },
      {
        "id": "daily-digest",
        "schedule": "0 8 * * *",
        "agentId": "wazuh-reporting",
        "model": "anthropic/claude-haiku-4-5"
      },
      {
        "id": "shift-handoff",
        "schedule": "0 6,14,22 * * *",
        "agentId": "wazuh-reporting",
        "model": "anthropic/claude-haiku-4-5"
      },
      {
        "id": "weekly-summary",
        "schedule": "0 9 * * 1",
        "agentId": "wazuh-reporting",
        "model": "anthropic/claude-sonnet-4-5"
      },
      {
        "id": "correlation-sweep",
        "schedule": "*/5 * * * *",
        "agentId": "wazuh-correlation",
        "model": "anthropic/claude-haiku-4-5"
      },
      {
        "id": "untriaged-sweep",
        "schedule": "*/10 * * * *",
        "agentId": "wazuh-triage",
        "model": "anthropic/claude-haiku-4-5"
      }
    ],
    "webhooks": [
      {
        "path": "/webhook/wazuh-alert",
        "target": "wazuh-triage",
        "trigger": "wazuh-alert"
      },
      {
        "path": "/webhook/case-created",
        "target": "wazuh-correlation",
        "trigger": "case-created"
      },
      {
        "path": "/webhook/investigation-request",
        "target": "wazuh-investigation",
        "trigger": "investigation-request"
      },
      {
        "path": "/webhook/plan-request",
        "target": "wazuh-response-planner",
        "trigger": "plan-request"
      },
      {
        "path": "/webhook/policy-check",
        "target": "wazuh-policy-guard",
        "trigger": "policy-check"
      },
      {
        "path": "/webhook/execute-action",
        "target": "wazuh-responder",
        "trigger": "execute-action"
      }
    ]
  },

  // =============================================================================
  // MEMORY CONFIGURATION
  // =============================================================================
  "memory": {
    "enabled": true,
    "search": {
      "provider": "openai",
      "model": "text-embedding-3-small",
      "hybrid": true,
      "bm25Weight": 0.3,
      "vectorWeight": 0.7
    },
    "compaction": {
      "enabled": true,
      "schedule": "daily"
    }
  },

  // =============================================================================
  // ENVIRONMENT VARIABLES
  // =============================================================================
  // Configure API keys for your preferred providers
  // Only configure keys for providers you intend to use
  // =============================================================================
  "env": {
    // OpenClaw Gateway
    "OPENCLAW_TOKEN": "${OPENCLAW_TOKEN}",

    // Wazuh MCP Server
    "WAZUH_MCP_URL": "${MCP_URL}",
    "WAZUH_MCP_TOKEN": "${AUTOPILOT_MCP_AUTH}",

    // ==========================================================================
    // LLM Provider API Keys
    // ==========================================================================

    // Anthropic (Claude) - https://console.anthropic.com/
    "ANTHROPIC_API_KEY": "${ANTHROPIC_API_KEY}",

    // OpenAI - https://platform.openai.com/api-keys
    "OPENAI_API_KEY": "${OPENAI_API_KEY}",

    // Google AI (Gemini) - https://aistudio.google.com/app/apikey
    "GOOGLE_API_KEY": "${GOOGLE_API_KEY}",

    // Groq (fast inference) - https://console.groq.com/keys
    "GROQ_API_KEY": "${GROQ_API_KEY}",

    // Mistral - https://console.mistral.ai/api-keys
    "MISTRAL_API_KEY": "${MISTRAL_API_KEY}",

    // xAI (Grok) - https://console.x.ai/
    "XAI_API_KEY": "${XAI_API_KEY}",

    // OpenRouter (300+ models) - https://openrouter.ai/keys
    "OPENROUTER_API_KEY": "${OPENROUTER_API_KEY}",

    // Together AI - https://api.together.xyz/settings/api-keys
    "TOGETHER_API_KEY": "${TOGETHER_API_KEY}",

    // Cerebras - https://cloud.cerebras.ai/
    "CEREBRAS_API_KEY": "${CEREBRAS_API_KEY}"
  },

  // =============================================================================
  // DEFAULT PROVIDER (used when no specific provider configured)
  // =============================================================================
  "provider": {
    "type": "anthropic",
    "apiKey": "${ANTHROPIC_API_KEY}",
    "timeout": 120000
  }
}
