{
  // =============================================================================
  // WAZUH OPENCLAW AUTOPILOT — OpenClaw Gateway Configuration
  // =============================================================================
  // JSON5 format: comments and trailing commas are allowed.
  // Validated by OpenClaw's strict zod schema — unknown keys prevent startup.
  // Run `openclaw doctor --fix` to diagnose issues.
  //
  // This is a REFERENCE TEMPLATE. The installer (install.sh) generates the
  // production config at ~/.openclaw/openclaw.json.
  //
  // Model format: "provider/model-name" (e.g., "anthropic/claude-sonnet-4-5")
  // Built-in providers: anthropic, openai, google, groq, mistral, xai
  // Custom providers (Ollama, OpenRouter, etc.): configure in "models" section
  // API keys: set via environment variables or in the "env" section below
  // =============================================================================

  // ---------------------------------------------------------------------------
  // GATEWAY
  // ---------------------------------------------------------------------------
  "gateway": {
    "port": 18789,
    "bind": "loopback",
    "auth": {
      "mode": "token",
      "token": "${OPENCLAW_TOKEN}"
    }
  },

  // ---------------------------------------------------------------------------
  // LOGGING
  // ---------------------------------------------------------------------------
  "logging": {
    "redactSensitive": "tools"
  },

  // ---------------------------------------------------------------------------
  // AGENT CONFIGURATION
  // ---------------------------------------------------------------------------
  "agents": {
    "defaults": {
      "workspace": "~/.openclaw/wazuh-autopilot/workspace",

      // Primary model + ordered fallbacks for all agents
      "model": {
        "primary": "anthropic/claude-sonnet-4-5",
        "fallbacks": [
          "openai/gpt-4o",
          "groq/llama-3.3-70b-versatile"
        ]
      },

      // Model aliases for quick switching via /model command
      "models": {
        "anthropic/claude-sonnet-4-5": { "alias": "sonnet" },
        "anthropic/claude-haiku-4-5": { "alias": "haiku" },
        "openai/gpt-4o": { "alias": "gpt4o" },
        "groq/llama-3.3-70b-versatile": { "alias": "groq" }
      },

      "sandbox": {
        "mode": "all",
        "scope": "session"
      },

      // Heartbeat: periodic health/sweep tasks using cheap model
      "heartbeat": {
        "every": "30m",
        "model": "anthropic/claude-haiku-4-5"
      },

      // Memory search using embeddings
      "memorySearch": {
        "sources": ["memory", "sessions"],
        "provider": "openai",
        "model": "text-embedding-3-small"
      },

      "maxConcurrent": 3,
      "timeoutSeconds": 600
    },

    "list": [
      // =====================================================================
      // TRIAGE AGENT — First responder for alert analysis
      // =====================================================================
      {
        "id": "wazuh-triage",
        "default": true,
        "workspace": "~/.openclaw/wazuh-autopilot/agents/triage",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/triage",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["write", "edit", "exec", "delete", "browser"]
        },
        "heartbeat": { "every": "10m" }
      },

      // =====================================================================
      // CORRELATION AGENT — Pattern detection and timeline building
      // =====================================================================
      {
        "id": "wazuh-correlation",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/correlation",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/correlation",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["write", "edit", "exec", "delete", "browser"]
        },
        "heartbeat": { "every": "5m" }
      },

      // =====================================================================
      // INVESTIGATION AGENT — Deep analysis and evidence gathering
      // =====================================================================
      {
        "id": "wazuh-investigation",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/investigation",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/investigation",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["write", "edit", "exec", "delete", "browser"]
        }
      },

      // =====================================================================
      // RESPONSE PLANNER — Generate response plans (no execution)
      // =====================================================================
      {
        "id": "wazuh-response-planner",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/response-planner",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/response-planner",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "write", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["exec", "delete", "browser"]
        }
      },

      // =====================================================================
      // POLICY GUARD — Constitutional enforcement
      // =====================================================================
      {
        "id": "wazuh-policy-guard",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/policy-guard",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/policy-guard",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["write", "edit", "exec", "delete", "browser"]
        }
      },

      // =====================================================================
      // RESPONDER — Action execution (requires elevated permissions)
      // =====================================================================
      {
        "id": "wazuh-responder",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/responder",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/responder",
        "model": {
          "primary": "anthropic/claude-sonnet-4-5",
          "fallbacks": ["openai/gpt-4o"]
        },
        "tools": {
          "profile": "coding",
          "allow": ["read", "write", "exec", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["browser", "delete"],
          "elevated": { "enabled": true }
        },
        "sandbox": {
          "mode": "all",
          "scope": "agent"
        }
      },

      // =====================================================================
      // REPORTING — Metrics, KPIs, and digest generation
      // =====================================================================
      {
        "id": "wazuh-reporting",
        "workspace": "~/.openclaw/wazuh-autopilot/agents/reporting",
        "agentDir": "~/.openclaw/wazuh-autopilot/agents/reporting",
        "model": "anthropic/claude-haiku-4-5",
        "tools": {
          "profile": "minimal",
          "allow": ["read", "write", "sessions_list", "sessions_history", "sessions_send"],
          "deny": ["exec", "delete", "browser"]
        }
      }
    ]
  },

  // ---------------------------------------------------------------------------
  // CHANNEL CONFIGURATION
  // ---------------------------------------------------------------------------
  // Slack is optional. Without it, agents operate via REST API and heartbeats.
  // Set SLACK_BOT_TOKEN and SLACK_APP_TOKEN in env to enable.
  // ---------------------------------------------------------------------------
  "channels": {
    "slack": {
      "enabled": true,
      "botToken": "${SLACK_BOT_TOKEN}",
      "appToken": "${SLACK_APP_TOKEN}",
      "dmPolicy": "open",
      "groupPolicy": "allowlist"
    }
  },

  // ---------------------------------------------------------------------------
  // MULTI-AGENT ROUTING
  // ---------------------------------------------------------------------------
  // Bindings route Slack messages to agents. Remove this section if Slack is
  // not used — agents will still operate via REST API and heartbeats.
  "bindings": [
    {
      "agentId": "wazuh-responder",
      "match": {
        "channel": "slack",
        "peer": { "kind": "group", "id": "approvals" }
      }
    },
    {
      "agentId": "wazuh-triage",
      "match": {
        "channel": "slack",
        "peer": { "kind": "group", "id": "*" }
      }
    }
  ],

  // ---------------------------------------------------------------------------
  // GLOBAL TOOL POLICY
  // ---------------------------------------------------------------------------
  "tools": {
    "profile": "minimal",
    "allow": ["read", "sessions_list", "sessions_history"],
    "deny": ["browser", "canvas"],
    "web": {
      "search": { "enabled": false },
      "fetch": { "enabled": false }
    }
  },

  // ---------------------------------------------------------------------------
  // CRON — Enable scheduled heartbeats and tasks
  // ---------------------------------------------------------------------------
  // Agent heartbeats handle periodic sweeps (triage/10m, correlation/5m).
  // Additional cron jobs can be added via: openclaw cron add
  // ---------------------------------------------------------------------------
  "cron": {
    "enabled": true,
    "maxConcurrentRuns": 3
  },

  // ---------------------------------------------------------------------------
  // HOOKS — Webhook endpoints for Wazuh alert routing
  // ---------------------------------------------------------------------------
  "hooks": {
    "enabled": true,
    "token": "${OPENCLAW_TOKEN}",
    "mappings": [
      {
        "match": { "path": "/webhook/wazuh-alert" },
        "action": "agent",
        "agentId": "wazuh-triage"
      },
      {
        "match": { "path": "/webhook/case-created" },
        "action": "agent",
        "agentId": "wazuh-correlation"
      },
      {
        "match": { "path": "/webhook/investigation-request" },
        "action": "agent",
        "agentId": "wazuh-investigation"
      },
      {
        "match": { "path": "/webhook/plan-request" },
        "action": "agent",
        "agentId": "wazuh-response-planner"
      },
      {
        "match": { "path": "/webhook/policy-check" },
        "action": "agent",
        "agentId": "wazuh-policy-guard"
      },
      {
        "match": { "path": "/webhook/execute-action" },
        "action": "agent",
        "agentId": "wazuh-responder"
      }
    ]
  },

  // ---------------------------------------------------------------------------
  // ENVIRONMENT VARIABLES
  // ---------------------------------------------------------------------------
  // API keys for LLM providers. Only configure keys for providers you use.
  // These can also be set as system environment variables.
  // ---------------------------------------------------------------------------
  "env": {
    "ANTHROPIC_API_KEY": "${ANTHROPIC_API_KEY}",
    "OPENAI_API_KEY": "${OPENAI_API_KEY}",
    "GOOGLE_API_KEY": "${GOOGLE_API_KEY}",
    "GROQ_API_KEY": "${GROQ_API_KEY}",
    "MISTRAL_API_KEY": "${MISTRAL_API_KEY}",
    "XAI_API_KEY": "${XAI_API_KEY}",
    "OPENROUTER_API_KEY": "${OPENROUTER_API_KEY}",
    "TOGETHER_API_KEY": "${TOGETHER_API_KEY}",
    "CEREBRAS_API_KEY": "${CEREBRAS_API_KEY}",
    "MCP_URL": "${MCP_URL}",
    "AUTOPILOT_MCP_AUTH": "${AUTOPILOT_MCP_AUTH}"
  }
}
