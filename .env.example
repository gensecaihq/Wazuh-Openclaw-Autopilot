# =============================================================================
# Wazuh OpenClaw Autopilot - Environment Configuration
# =============================================================================
# Copy this file to .env and configure all required values
# =============================================================================

# -----------------------------------------------------------------------------
# Core Configuration
# -----------------------------------------------------------------------------

# Operating mode: bootstrap | production
AUTOPILOT_MODE=bootstrap

# Enable responder capability (execution still requires human approval)
# Set to true only after configuring policies and approvers
AUTOPILOT_RESPONDER_ENABLED=false

# Require Tailscale VPN for MCP connections (recommended for production)
AUTOPILOT_REQUIRE_TAILSCALE=true

# -----------------------------------------------------------------------------
# MCP Server Configuration
# -----------------------------------------------------------------------------

# MCP Server URL (Wazuh MCP Server)
# For Tailscale: https://100.x.x.x:8080 or https://your-server.ts.net:8080
MCP_URL=https://localhost:8080

# Bootstrap MCP URL (used in bootstrap mode if MCP_URL not set)
# Can be any reachable URL including LAN or public addresses
MCP_BOOTSTRAP_URL=

# MCP Authentication Token
AUTOPILOT_MCP_AUTH=your-mcp-auth-token

# MCP request timeout (milliseconds)
MCP_TIMEOUT_MS=30000

# -----------------------------------------------------------------------------
# Data & Configuration Paths
# -----------------------------------------------------------------------------

# Directory for persistent data (cases, reports, state)
AUTOPILOT_DATA_DIR=/var/lib/wazuh-autopilot

# Directory for configuration files (policies, toolmap)
AUTOPILOT_CONFIG_DIR=/etc/wazuh-autopilot

# -----------------------------------------------------------------------------
# Metrics & Observability
# -----------------------------------------------------------------------------

# Enable Prometheus metrics endpoint
METRICS_ENABLED=true

# Service port (primary; METRICS_PORT accepted as backward-compat alias)
RUNTIME_PORT=9090

# Metrics server bind address (use 127.0.0.1 for localhost-only)
METRICS_HOST=127.0.0.1

# Log format: json | text
LOG_FORMAT=json

# Log level: debug | info | warn | error
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Approval Configuration
# -----------------------------------------------------------------------------

# Approval token TTL in minutes
APPROVAL_TOKEN_TTL_MINUTES=60

# Response plan expiry in minutes
PLAN_EXPIRY_MINUTES=60

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------

# Rate limit window in milliseconds
RATE_LIMIT_WINDOW_MS=60000

# Maximum requests per window
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# Auth Failure Protection
# -----------------------------------------------------------------------------

# Time window for tracking auth failures (milliseconds)
AUTH_FAILURE_WINDOW_MS=900000

# Max auth failures before lockout
AUTH_FAILURE_MAX_ATTEMPTS=5

# Lockout duration after max failures (milliseconds)
AUTH_LOCKOUT_DURATION_MS=1800000

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------

# Allowed CORS origin (for web UI if applicable)
CORS_ORIGIN=http://localhost:3000

# Enable CORS headers (set to false to disable)
CORS_ENABLED=true

# -----------------------------------------------------------------------------
# Graceful Shutdown
# -----------------------------------------------------------------------------

# Timeout for graceful shutdown (milliseconds)
SHUTDOWN_TIMEOUT_MS=30000

# -----------------------------------------------------------------------------
# Wazuh Manager API (optional - used by health checks)
# -----------------------------------------------------------------------------

# Wazuh API URL
# WAZUH_API_URL=https://127.0.0.1:55000

# Wazuh API username
# WAZUH_API_USER=wazuh-wui

# Wazuh API password
# WAZUH_API_PASSWORD=

# -----------------------------------------------------------------------------
# Slack Integration (Optional)
# -----------------------------------------------------------------------------
# See docs/SLACK_SOCKET_MODE.md for setup instructions

# Slack App-Level Token (starts with xapp-)
# Required for Socket Mode connection
SLACK_APP_TOKEN=

# Slack Bot Token (starts with xoxb-)
# Required for posting messages
SLACK_BOT_TOKEN=

# Slack signing secret (optional for Socket Mode)
SLACK_SIGNING_SECRET=

# Channel IDs for notifications
SLACK_ALERTS_CHANNEL=
SLACK_APPROVALS_CHANNEL=
SLACK_REPORTS_CHANNEL=

# -----------------------------------------------------------------------------
# OpenClaw Configuration
# -----------------------------------------------------------------------------

# OpenClaw Gateway Token
OPENCLAW_TOKEN=your-openclaw-gateway-token

# -----------------------------------------------------------------------------
# LLM Provider API Keys
# -----------------------------------------------------------------------------
# Configure keys for your preferred providers. You only need to set keys
# for providers you intend to use. See openclaw/openclaw.json for model config.
#
# Provider documentation:
# - Anthropic: https://console.anthropic.com/
# - OpenAI: https://platform.openai.com/api-keys
# - Google: https://aistudio.google.com/app/apikey
# - Groq: https://console.groq.com/keys
# - Mistral: https://console.mistral.ai/api-keys
# - xAI: https://console.x.ai/
# - OpenRouter: https://openrouter.ai/keys
# - Together: https://api.together.xyz/settings/api-keys
# -----------------------------------------------------------------------------

# Anthropic (Claude) - Recommended for SOC tasks
# Models: claude-opus-4-5, claude-sonnet-4-5, claude-haiku-4-5
ANTHROPIC_API_KEY=sk-ant-...

# OpenAI - Also used for embeddings in memory search
# Models: gpt-4o, gpt-4.5-preview, o3-mini
OPENAI_API_KEY=sk-...

# Google AI (Gemini) - Multimodal capabilities
# Models: gemini-2.0-flash, gemini-2.0-pro
GOOGLE_API_KEY=

# Groq - Ultra-fast inference (free tier available)
# Models: llama-3.3-70b-versatile, mixtral-8x7b-32768
GROQ_API_KEY=

# Mistral - European AI provider
# Models: mistral-large-latest, codestral-latest
MISTRAL_API_KEY=

# xAI (Grok) - X/Twitter's AI
# Models: grok-2, grok-3
XAI_API_KEY=

# OpenRouter - Access 300+ models via single API
# Models: anthropic/claude-3.5-sonnet, meta-llama/llama-3.3-70b, etc.
OPENROUTER_API_KEY=

# Together AI - Open-source model hosting
TOGETHER_API_KEY=

# Cerebras - Ultra-fast inference
CEREBRAS_API_KEY=

# -----------------------------------------------------------------------------
# Internal Service Authentication
# -----------------------------------------------------------------------------

# Internal service token for agent-to-service communication
AUTOPILOT_SERVICE_TOKEN=
